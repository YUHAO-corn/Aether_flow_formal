# 协作指南

## 需要用户操作时输出这些到文档
### 核心诉求  
一份**标准化协作流程文档**，明确：  
1. ​**触发条件** - 何时需要您介入  
2. ​**操作步骤** - 您需要执行的具体动作  
3. ​**输入输出** - 需您提供/确认的材料格式  

### 文档形式要求  
- 使用Markdown编写  
- 按场景分章节，每个场景包含3-5个步骤  
- 禁用技术术语，用「if...then...」条件式语句  

### 程序员需产出  
▸ 包含常见协作场景的SOP框架（如接口冲突/数据验证/权限申请）  
▸ 每个步骤附带清晰的状态标签（如[审批]/[数据输入]/[紧急响应]）  

请确认框架后，我将补充具体业务规则。

## 你（AI助手）操作时可能需要参考的内容

### 完成功能开发时需要进行的测试类型

1. **单元测试**：测试独立的函数和组件
2. **集成测试**：测试多个组件或模块的交互
3. **端到端测试**：模拟用户行为的完整测试

#### 测试覆盖率要求

- 核心业务逻辑：>90%
- 工具函数：>80%
- UI组件：>70%

### 文档更新流程

1. 完成阶段性开发时同步更新相关文档
2. 文档变更需要经过审查
3. 保持文档与代码的一致性

## 沟通协作工具

1. **代码托管**：GitHub
2. **任务管理**：项目记录/任务跟踪文档.md
3. **文档共享**：项目记录目录
4. **需求交代**：开发需求目录（用户要求时阅读）

## 项目
4. **即时通讯**：

## 协作注意事项

1. 保持良好的沟通，及时反馈问题
2. 遵循代码规范和文档规范
3. 定期进行代码审查和知识分享
4. 尊重团队成员的工作和意见

## 测试框架协作场景

### 场景一：安装缺失的测试依赖 [数据输入]

**触发条件**：如果运行测试时出现缺少依赖的错误信息

**操作步骤**：
1. 打开终端，进入项目后端目录
2. 运行以下命令安装缺失的依赖：
   ```bash
   cd AetherFlow_backend
   npm install --save-dev jest-mock-req-res
   ```
3. 确认安装成功（无错误信息）

**输入输出**：
- 输入：终端命令
- 输出：安装成功的确认信息

### 场景二：处理测试超时问题 [紧急响应]

**触发条件**：如果测试运行时出现"Exceeded timeout"错误

**操作步骤**：
1. 使用非并行模式运行测试：
   ```bash
   cd AetherFlow_backend
   ./scripts/test.sh --no-parallel --verbose
   ```
2. 如果仍然超时，可以尝试增加超时时间：
   ```bash
   cd AetherFlow_backend
   NODE_ENV=test JEST_TIMEOUT=120000 npm test
   ```
3. 将测试结果截图或复制终端输出提供给开发团队

**输入输出**：
- 输入：终端命令
- 输出：测试运行结果（成功或失败信息）

### 场景三：提供测试环境信息 [数据输入]

**触发条件**：如果开发团队需要了解您的测试环境

**操作步骤**：
1. 运行以下命令收集环境信息：
   ```bash
   cd AetherFlow_backend
   node -v
   npm -v
   cat package.json | grep mongodb-memory-server
   ```
2. 复制输出结果
3. 提供给开发团队

**输入输出**：
- 输入：终端命令
- 输出：环境版本信息

### 场景四：手动验证测试覆盖率 [审批]

**触发条件**：如果需要确认测试覆盖率是否达到要求

**操作步骤**：
1. 运行覆盖率测试：
   ```bash
   cd AetherFlow_backend
   npm run test:coverage
   ```
2. 查看生成的覆盖率报告（位于`coverage/lcov-report/index.html`）
3. 确认核心业务逻辑覆盖率是否>90%，工具函数是否>80%
4. 将结果反馈给开发团队

**输入输出**：
- 输入：终端命令
- 输出：覆盖率报告和您的确认结果

### 场景五：运行单个测试文件 [故障排除]

**触发条件**：如果需要单独测试某个功能模块

**操作步骤**：
1. 使用测试脚本运行特定测试：
   ```bash
   cd AetherFlow_backend
   # 运行认证相关测试
   npm run test:auth
   # 或使用通用命令
   ./scripts/test.sh --pattern=auth
   ```
2. 观察测试结果
3. 如果测试失败，记录错误信息

**输入输出**：
- 输入：测试命令
- 输出：特定模块的测试结果

### 场景六：解决数据库连接问题 [故障排除]

**触发条件**：如果测试中出现数据库连接错误

**操作步骤**：
1. 确认MongoDB服务是否正在运行（如果使用本地MongoDB）
2. 检查环境变量设置：
   ```bash
   cd AetherFlow_backend
   # 查看.env文件
   cat .env | grep MONGODB
   ```
3. 使用内存数据库运行测试：
   ```bash
   cd AetherFlow_backend
   MOCK_DB=true npm test
   ```

**输入输出**：
- 输入：检查命令和测试命令
- 输出：环境变量信息和测试结果

### 场景七：生成详细测试报告 [数据分析]

**触发条件**：如果需要分析测试性能或问题

**操作步骤**：
1. 运行测试并生成详细报告：
   ```bash
   cd AetherFlow_backend
   npm run test:report
   ```
2. 查看生成的报告文件（位于`test-results/test-report.json`）
3. 分析报告中的测试执行时间和失败原因
4. 将分析结果提供给开发团队

**输入输出**：
- 输入：测试报告命令
- 输出：测试报告文件和分析结果
