# AetherFlow 功能测试指南

##重要说明
在每次要求用户人工测试前，AI助手都需要完成环境准备和开发者准备工作，除非遇到权限不够的时候，则告知用户哪些需要用户人工操作

**开发者责任**：作为开发者，我负责完成所有前置准备工作，包括环境配置、服务启动和测试数据准备。在每次测试前，我会确保所有服务正常运行，并通知测试人员可以开始测试。

**测试人员责任**：测试人员负责按照测试步骤操作，并记录测试结果。如果遇到问题，请提供详细的错误信息和复现步骤，以便开发者进行排查和修复。

## 环境准备

### Windows PowerShell 特别说明
在 Windows PowerShell 中，`&&` 不是有效的命令分隔符，请分开执行每条命令。另外，请注意当前工作目录，确保在正确的目录中执行命令。

Windows环境下的其他注意事项：
1. 前端项目中的`cleanup.sh`脚本在Windows下无法执行，已修改package.json中的脚本配置
2. 使用反斜杠`\`而不是正斜杠`/`作为路径分隔符
3. 某些命令（如`cat`）在Windows下不可用，请使用对应的Windows命令（如`type`）
4. 如果遇到权限问题，请尝试以管理员身份运行PowerShell

### 使用IP地址访问服务
如果使用localhost访问服务时遇到连接问题，可以尝试使用本机IP地址代替localhost：

1. 使用`ipconfig`命令查看本机IP地址（通常是192.168.x.x格式）
2. 使用IP地址访问服务，例如：
   - 后端服务：http://192.168.1.15:3000
   - 前端服务：http://192.168.1.15:5173

已修改前端服务配置，使其监听所有网络接口（0.0.0.0），这样可以通过IP地址访问。

### 无MongoDB环境下运行
本项目已经进行了适配，可以在没有安装MongoDB的环境下运行，但某些需要数据库的功能将不可用。系统会自动检测MongoDB连接状态，并在连接失败时切换到模拟数据库模式。

在模拟数据库模式下：
1. 服务器会正常启动，但会显示警告信息
2. 所有需要数据库的API调用可能会返回错误
3. 基本的页面浏览和UI交互仍然可用
4. 建议仅用于前端UI测试和开发

### 后端服务启动
```powershell
# 进入后端目录
cd AetherFlow_v1/AetherFlow_backend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

### 前端服务启动
```powershell
# 进入前端目录
cd AetherFlow_v1/AetherFlow_web_front

# 安装依赖（如果遇到依赖冲突，使用--legacy-peer-deps参数）
npm install --legacy-peer-deps

# 启动开发服务器
npm run dev
```

### 常见问题解决方案

#### 依赖安装问题
如果遇到依赖冲突或安装失败，可以尝试以下命令：
```powershell
# 使用legacy-peer-deps参数
npm install --legacy-peer-deps

# 或者使用force参数
npm install --force
```

#### 端口占用问题
如果端口被占用，可以修改端口或关闭占用端口的程序：
```powershell
# 查看端口占用
netstat -ano | findstr 3000
netstat -ano | findstr 5173

# 关闭占用进程（PID为上一步查询到的进程ID）
taskkill /F /PID <PID>
```

#### 服务无法访问
如果服务启动后无法访问，请检查：
1. 确认服务是否成功启动，查看控制台输出
2. 检查防火墙设置是否阻止了连接
3. 尝试使用不同的浏览器访问
4. 检查MongoDB是否正常运行（后端服务需要，但现在已支持无MongoDB模式）
5. 检查网络连接是否正常，尝试ping localhost
6. 尝试使用IP地址代替localhost（如http://127.0.0.1:5173）

## 注册/登录功能测试步骤

### 开发者准备工作
1. 准备测试数据和测试账号。
2. 确保MongoDB数据库已启动并连接正常（如果有）。
3. 配置正确的环境变量（.env文件）。
4. 启动后端服务并检查日志输出。
5. 启动前端服务并确认可以访问。
6. 准备好记录测试结果的文档。
7. 清除浏览器缓存和Cookie以确保测试环境干净。

### 测试人员操作步骤
1. 访问本地前端服务（http://localhost:5173 或 http://127.0.0.1:5173）。
2. 进入注册页面并填写注册信息。
3. 提交注册表单并观察结果。
4. 进入登录页面并使用刚注册的账号登录。
5. 测试密码验证功能（输入短密码）。
6. 测试密码匹配功能（输入不一致的密码）。
7. 测试邮箱已存在功能（使用已注册邮箱）。
8. 测试登录失败功能（使用错误凭据）。
9. 测试登出功能。
10. 记录每个测试步骤的结果。

## 浏览器插件测试

### 构建插件
```powershell
# 进入插件目录
cd AetherFlow_v1/AetherFlow_plugin_front

# 安装依赖
npm install

# 构建插件
npm run build
```

### 加载插件
1. 打开Chrome浏览器
2. 访问 chrome://extensions/
3. 开启"开发者模式"（右上角开关）
4. 点击"加载已解压的扩展程序"
5. 选择 `AetherFlow_v1/AetherFlow_plugin_front/dist` 目录

## 问题排查指南

### 单元测试失败
- 检查测试环境配置是否正确
- 检查模拟数据和处理程序是否正确
- 检查测试用例中的断言是否合理
- 查看具体的错误信息，定位问题所在

### 后端服务启动失败
- 检查MongoDB是否已安装并启动（如果需要完整功能）
- 检查环境变量配置是否正确（.env文件）
- 检查端口是否被占用（默认3000端口）
- 检查日志输出，查找具体错误信息

### 前端服务启动失败
- 检查Node.js版本是否兼容（推荐使用v16+）
- 检查依赖是否正确安装
- 检查环境变量配置是否正确（.env文件）
- 检查vite配置是否正确

### 浏览器插件加载失败
- 检查构建是否成功，dist目录是否生成
- 检查manifest.json配置是否正确
- 检查浏览器版本是否兼容
- 查看浏览器控制台是否有错误信息

### 无法连接到服务
- 尝试使用IP地址代替localhost（如http://127.0.0.1:5173）
- 检查防火墙设置是否阻止了连接
- 尝试关闭杀毒软件或添加例外
- 检查网络适配器设置是否正确
- 尝试重启网络服务或计算机


