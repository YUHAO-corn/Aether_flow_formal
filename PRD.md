# AetherFlow 产品需求文档 (PRD)

## 产品名和产品愿景
- 产品名：AetherFlow (中文名：「以太流动」）
- 产品愿景：让AI潜能随需释放

## 产品概述
这是一款浏览器插件与网页端的混合产品，用户使用它可以快速调用Prompt和管理Prompt。产品旨在帮助用户更高效地使用AI平台，通过自动捕获、优化和管理提示词，提升用户与AI交互的效率和质量。

## 功能架构
AetherFlow产品分为两个主要部分：浏览器插件和网页端应用。两者功能有明确的职责分离，共同构成完整的产品体验。

- **浏览器插件**：专注于实时交互功能，包括自动捕获对话、提示词快捷输入、提示词优化等，直接增强用户在AI平台上的使用体验。
- **网页端应用**：专注于资产管理功能，包括提示词管理、分析仪表盘、沙盒调试等，提供更全面的提示词管理和分析能力。

## 核心功能

### 浏览器插件功能
- 功能概述：实现Prompt的调用和存储
- 界面描述：

#### 1. 自动捕获/保存 (AutoSave)（P0）
  - 功能描述：用户每次与AI平台对话时，每当新一轮对话完成时自动捕获这轮对话并存储对话信息，包括使用哪个AI平台、时间、链接、本轮提问与本轮回答
  - 滚动存储机制：每个用户默认保留最近100条未收藏的对话，超限时自动删除最旧未收藏内容（备注：100条不能写死，未来有调整空间）
  - 支持平台：ChatGPT、Claude、Bard/Gemini等主流AI对话平台
  - 实现组件：AutoSave.jsx
  - 实现状态：✅ 已完成

#### 2. 提示词快捷输入 (Prompt Image)（P0）
  - 功能需求：用户在主页面（AI平台）输入框中输入"/"后跟随关键词（例如"/文本"），系统实时搜索所有备选项，筛选出包含关键词（如"文本"）的内容，将匹配的备选项以下拉菜单的形式展示，每个菜单项以简洁的字体显示，选项之间有适当的间距，确保清晰易读。用户点击或选择某个选项后，系统执行插入这项提示词到输入框的操作。
  - 联想逻辑：使用精准匹配包含关键词的提示词，再将符合要求的提示词按"收藏>高频使用>低频使用"的顺序排列
  - 支持平台：与自动捕获功能支持的平台保持一致
  - 实现状态：🔄 开发中

#### 3. 提示词库 (PromptLibrary)（P0）
  - 功能需求：插件侧边栏展示提示词卡片列表，点击卡片后出现模态窗口，模态窗口右下角包含插入和复制按钮，用户点击插入按钮后将这条提示词插入到AI平台输入框。
  - 卡片操作和排序规则：卡片展示已存储和已收藏的Prompt，支持滚动翻阅，支持关键词搜索，支持通过使用频率（由多到少）/收藏（有收藏优先）/存储时间（由新到旧）排序，未选择时默认使用存储时间排序
  - 数据同步：与网页端提示词管理功能共享数据，确保用户在任何端都能访问完整的提示词库
  - 实现组件：PromptLibrary.jsx
  - 实现状态：✅ 已完成

#### 4. 提示词优化 (PromptEnhancement)（P1）
  - 功能需求：在插件侧边栏提供优化Prompt功能，用户可在输入框中输入原始Prompt，系统以具有惊喜感和仪式感的方式返回优化后的Prompt；优化结果支持继续优化、一键插入输入框或复制到剪贴板。
  - 界面需求：在插件侧边栏中划分输入框和优化结果框，输入原始Prompt后以动态效果展示优化结果，并提供"继续优化"、"插入"和"复制"功能按钮，结果呈现过程具有仪式感和惊喜感。
  - 优化策略：
    - 结构优化：添加清晰的结构，如背景、任务、格式要求等部分
    - 明确性增强：消除模糊表述，增加具体细节和明确指令
    - 上下文丰富：添加必要的背景信息和上下文
    - 格式规范化：提供更好的格式和组织，使AI更容易理解和执行
  - 实现组件：PromptEnhancement.jsx
  - 实现状态：✅ 已完成

#### 5. 智能建议 (SmartSuggestions)（P2）
  - 功能需求：系统预设提示词卡片。功能与提示词库相似，智能建议的提示词来源于系统准备的提示词数据库（区别于提示词库提示词来源于用户存储）
  - 建议分类：按照不同场景和用途分类，如创意写作、代码生成、数据分析等
  - 更新机制：系统定期更新建议库，确保建议的质量和多样性
  - 实现组件：SmartSuggestions.jsx
  - 实现状态：✅ 已完成

### 网页端功能
功能目的：Prompt的资产管理

#### 1. 提示词管理
- 保存浏览（P0）
  - 卡片功能需求：展示用户已保存的提示词卡片，支持查看信息、收藏提示词、编辑标签
  - 卡片点击后出现模态窗口，展示信息包括：使用哪个AI平台、时间、原始对话链接、本轮提示词与响应回答、本条提示词的五个评分纬度得分
  - 实现组件：PromptCard.tsx, TagNavigation.tsx
  - 实现状态：✅ 已完成
- 搜索（P0）
  - 功能需求：提供关键词搜索功能
  - 界面需求：位于界面顶部，支持实时关键词搜索，结果动态更新
  - 实现状态：✅ 已完成
- 标签（P0）
  - 功能需求：默认按保存时间和收藏状态排序，支持通过关键词搜索或标签筛选；允许用户手动编辑标签，双击标签栏即可进行编辑
  - 实现状态：✅ 已完成
- 排序和筛选
  - 提供默认排序选项（如保存时间、收藏状态），并支持通过标签或关键词进一步筛选，界面布局简洁，操作直观。
  - 实现状态：✅ 已完成

#### 2. 分析仪表盘 (AnalyticsDashboard)
  - 功能需求：展示用户提示词使用情况的数据可视化
  - 需要的图表和数据
    - 词云图（标签频数）：直观展示用户最常使用的标签和关键词
    - 雷达图（提示词质量评分）：从多个维度展示提示词的质量评分
    - 热力图（用户使用时间分布）：展示用户使用提示词的时间分布
  - 数据更新：实时或定期更新，确保数据的准确性
  - 实现组件：AnalyticsDashboard.tsx, WordCloud.tsx, RadarChart.tsx
  - 实现状态：✅ 已完成

#### 3. 提示词优化 (PromptLaboratory)
  - 功能需求：提供提示词优化功能，用户可输入原始提示词，系统返回优化后的版本
  - 优化策略：与插件端提示词优化功能类似，但提供更多高级选项和详细的优化说明
  - 支持多种优化模式：基础优化、创意优化、技术优化等
  - 实现组件：PromptLaboratory.tsx
  - 实现状态：✅ 已完成
  - 附加功能：该组件同时提供沙盒调试功能，支持用户选择大模型类型，输入提示词与大模型对话测试并获得回答

#### 4. 沙盒调试 (SandboxDebug)
  - 功能需求：网页端内嵌调试面板，支持优化prompt、输入Prompt与大模型对话测试并获得回答、并保存，可以选择大模型的类型
  - 支持的模型：GPT-4、GPT-3.5、Claude、Llama等主流大语言模型
  - 调试功能：支持调整模型参数（如温度、最大长度等），查看响应时间和token使用情况
  - 实现状态：🔄 开发中
  - 说明：此功能已集成在提示词优化(PromptLaboratory)组件中，无需单独开发

#### 5. 隐藏功能
  - 活动日志 (ActivityLog)：记录用户活动，提供统计和查询功能（通过控制台命令或连续点击标题7次触发）
    - 记录内容：用户的所有操作，包括提示词创建、编辑、删除、优化等
    - 统计功能：按时间、操作类型等维度统计用户活动
    - 实现状态：✅ 已完成
  - 功能检查工具 (FunctionalityChecker)：检查系统核心功能的可用性（通过控制台命令或特定操作触发）
    - 检查内容：API连接、数据同步、模型可用性等
    - 实现状态：✅ 已完成

## 功能职责分离

为明确功能边界，特此说明：

1. 自动捕获/保存功能仅在浏览器插件中实现，网页端不提供此功能
2. 提示词管理是网页端的核心功能，插件端通过提示词库提供类似但简化的功能
3. 提示词优化在网页端和插件端都有实现，但针对不同使用场景有所区别：
   - 网页端：PromptLaboratory组件，提供更完整的优化体验
   - 插件端：PromptEnhancement组件，提供快速优化功能
4. 分析仪表盘仅在网页端实现
5. 智能建议仅在插件端实现

## 数据流转

1. 浏览器插件捕获用户与AI平台的对话，并将数据发送到后端存储
2. 网页端从后端获取存储的提示词数据，进行展示和管理
3. 用户在任一端对提示词的修改都会同步到后端，并在另一端更新
4. 提示词优化功能在两端都可使用，但优化结果可能因端而异

## 后端开发准则
1. 严格遵循前后端分离原则,通过标准化的 API 接口进行数据交互
2. 确保所有后端更改不会破坏现有前端功能和用户界面
3. 后端 API 需要:
  - 保持与现有前端接口规范一致
  - 返回标准格式的数据结构
  - 提供适当的错误处理机制
4. 在开发过程中:
  - 先在测试环境进行接口验证
  - 确保向后兼容性
  - 记录所有 API 变更
5. 如需调整接口,应:
  - 提前与前端团队沟通
  - 制定过渡方案
  - 保留原接口直到前端完成适配
请在完成每个后端功能后进行完整的接口测试,确保与前端的无缝对接。

## 模块化开发准则
请按以下流程进行模块化开发:
1. 模块需求确认
- 列出该模块的具体功能点和目标
- 用2-3句话描述核心功能
- 明确输入输出和接口规范
- 获得需求确认后再开始开发

2. 测试用例设计
- 编写单元测试用例覆盖主要功能点
- 包含正常流程和异常场景测试
- 设置测试数据和预期结果
- 实现自动化测试脚本

3. 调试计划制定  
- 确定关键调试点和日志记录
- 准备调试工具和环境
- 制定问题定位和修复流程

4. 开发实现
- 遵循模块设计规范进行编码
- 实时运行测试保证质量
- 完善注释和文档
- 进行代码审查

请在每个模块开发前与我确认以上内容,以确保开发方向正确。

## 界面描述

### 浏览器插件（侧边栏插件）
1. 设计风格
  - 主题：魔法和黑暗
  - 需要有丰富的魔法元素与动效用户在页面的交互应该都会有反馈体验，例如触摸到卡片时会有变化
  - 不要使用魔法一类的文字描述，否则用户读不懂功能
2. 导航栏：位于插件顶部，采用标签式或按钮式布局，点击后高亮显示当前选中功能，界面风格统一且易于识别。
3. 功能界面：
  - 提示词库 (PromptLibrary)（侧边栏展示卡片列表）
    - 支持滚动、搜索和标签筛选
    - 每条Prompt清晰标注标签/提示词/提示词回答等属性
    - 点击卡片后以模态窗口展示完整内容、插入按钮、复制按钮
  - 提示词优化 (PromptEnhancement)（侧边栏展示对话框）
    - 侧边栏划分为输入框和优化结果框
    - 优化结果的加载动画阶段：
      1. 显示居中的旋转指示器（2秒）
      2. 转变为带有粒子效果的脉动魔法球（2秒）
      3. 显示"正在优化您的提示..."并带有动态省略号（1.5秒）
    - 优化结果的结果显示阶段：
      1. 淡入一个带有渐变边框动画的容器
      2. 以逐字符打字效果显示优化后的文本
      3. 在容器周围应用柔和的发光效果
    - 优化结果框交互功能：​
      1. 将复制按钮放置在右上角
      2. 在成功复制时显示勾号动画
      3. 添加悬停状态，包括缩放变换（1.05倍）和阴影增强
      4. 包含细微的按钮按下动画
    - 优化结果框配备操作按钮：继续优化、插入、复制
  - 智能建议 (SmartSuggestions)：在输入框下方或侧边以悬浮卡片形式动态展示推荐内容，点击后自动填充至输入框，设计轻量且不干扰用户操作。
  - 自动捕获/保存 (AutoSave)（小型浮动通知固定在界面底部）
    - 提示用户最近一次已经自动保存
    - 点击时拉出列表显示最近存储记录

### 网页端
官网界面需求概述
设计主题：魔法主题/最好是黑暗的，每一个提示词就像魔法咒语。记住这个界面一定要酷，需要有丰富的魔法元素与动效，让用户像置身于魔法游戏里，用户在页面的交互应该都会有反馈体验，例如触摸到卡片时会有变化。你需要尽可能地丰富你的想象力尽情补充细节。(但是不要真的使用魔法一类的文字描述，否则用户读不懂功能)
1. 提示词管理模块
  - 布局框架：采用左右分栏或顶部导航+主内容区的结构，确保功能分区清晰。
  - 核心组件：
    - 卡片展示区：以网格或列表形式展示提示词卡片，每条卡片包含提示词内容、回复摘要、标签及操作按钮
      - 卡片上的细节：有收藏按钮，有复制按钮，没有标签时默认会有三个空白标签格，双击标签格子可以编辑
      - 点击卡片：弹出模态窗口，完整展示提示词、AI回答、记录时间、标签及来源平台，支持编辑、复制和删除操作。
    - 搜索栏：固定在页面顶部，支持实时关键词搜索，结果动态刷新。
    - 标签栏：位于左侧或顶部，展示可筛选的标签列表，支持双击编辑标签，点击标签快速过滤内容。
    - 排序与筛选控件：在列表上方提供下拉菜单（如按时间、收藏状态排序），并与标签、搜索功能联动筛选。
2. 分析仪表盘模块 (AnalyticsDashboard)
  - 数字卡片：反映核心数据和变化
  - 数据图表：通过词云图、热力图、环形图等图表形式，集中展示用户Prompt资产的关键数据（如高频词分布、使用趋势、收藏占比）。
  - 交互设计：图表支持点击交互
3. 提示词实验室模块 (PromptLaboratory)
  - 功能分区：
    - 左侧区域：提供模型选择和提示词输入区，支持优化提示词功能
    - 右侧区域：提供与大模型对话测试功能，展示对话历史
    - 操作按钮：优化结果区配备"继续优化"、"保存"和"复制"按钮，对话区支持发送消息和查看响应
  - 整体布局：采用左右分栏形式，左侧用于提示词输入和优化，右侧用于与大模型对话测试

## 术语统一

为避免混淆，以下是一些需要统一的术语：

1. "资产仪表盘"统一为"分析仪表盘"(AnalyticsDashboard)
2. "Prompt Image"统一为"提示词快捷输入"
3. "系统推荐"和"Suggestion"统一为"智能建议"(SmartSuggestions)
4. "沙盒调试"功能已集成在"提示词实验室"(PromptLaboratory)中，不作为独立功能
5. "Prompt Capture and Save"统一为"自动捕获/保存"(AutoSave)
6. "Prompt library"统一为"提示词库"(PromptLibrary)
7. "Prompt enhancement"统一为"提示词优化"，在插件端为PromptEnhancement，在网页端为PromptLaboratory